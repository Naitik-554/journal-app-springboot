# **Journal App API Documentation**

## **Overview**
This documentation provides an overview of the Journal App's API endpoints built using Spring Boot. The app allows for managing users, journal entries, and provides public access for basic actions like health checks and user registration.

---

## **1. Data Models**

### **1.1 JournalEntry**
The `JournalEntry` class represents an individual journal entry. It is associated with a user and contains the title, content, and the date of the entry.

#### **Fields**
- **id** (`ObjectId`): Unique identifier for the journal entry (automatically generated by MongoDB).
- **title** (`String`): The title of the journal entry (cannot be null).
- **content** (`String`): The content or body of the journal entry (optional).
- **date** (`Date`): The date when the journal entry was created.

#### **Example JournalEntry Object:**
```json
{
  "id": "607d2f8b1e7f1a3f383a9155",
  "title": "My first journal",
  "content": "Today I learned about Spring Boot...",
  "date": "2025-01-23T12:30:00Z"
}
```

#### **Annotations:**
- `@Document(collection = "journal_entries")`: Specifies that this object is stored in the `journal_entries` collection in MongoDB.
- `@Id`: Marks the `id` field as the identifier of the document.
- `@NonNull`: Ensures that the `title` field cannot be `null`.
- `@Data`: Automatically generates getter, setter, `toString`, `equals`, and `hashCode` methods.
- `@NoArgsConstructor`: Generates a no-argument constructor.

---

### **1.2 User**
The `User` class represents an individual user of the app. A user can have multiple journal entries associated with them, and they may also have various roles (e.g., admin, regular user).

#### **Fields**
- **id** (`ObjectId`): Unique identifier for the user (automatically generated by MongoDB).
- **userName** (`String`): Unique username for the user (cannot be null).
- **password** (`String`): Password of the user (cannot be null).
- **journalEntries** (`List<JournalEntry>`): A list of journal entries associated with the user (a user can have multiple entries).
- **roles** (`List<String>`): A list of roles assigned to the user (e.g., admin, user).

#### **Example User Object:**
```json
{
  "id": "607d2f8b1e7f1a3f383a914f",
  "userName": "john_doe",
  "password": "secure_password",
  "journalEntries": [
    {
      "id": "607d2f8b1e7f1a3f383a9155",
      "title": "My first journal",
      "content": "Today I learned about Spring Boot...",
      "date": "2025-01-23T12:30:00Z"
    }
  ],
  "roles": ["user"]
}
```

#### **Annotations:**
- `@Document(collection = "users")`: Specifies that this object is stored in the `users` collection in MongoDB.
- `@Id`: Marks the `id` field as the identifier of the document.
- `@Indexed(unique = true)`: Ensures the `userName` field is unique across all users.
- `@DBRef`: Establishes a reference to the `JournalEntry` class, linking the journal entries to the user.
- `@NonNull`: Ensures that the `userName` and `password` fields cannot be `null`.
- `@Data`: Automatically generates getter, setter, `toString`, `equals`, and `hashCode` methods.

---

## **2. PublicController**

The `PublicController` class exposes public-facing endpoints for basic app functionality, such as health check and user registration.

### **Endpoints**

#### 2.1 **GET /public/health-check**
Performs a basic health check of the app, confirming that the server is up and running.

- **Method**: `GET`
- **Request**: None
- **Response**:
  - **200 OK**: Returns a message indicating the app is running.

**Example Request:**
```http
GET /public/health-check
```

**Example Response:**
```text
All OK!
```

#### 2.2 **POST /public/create-user**
Creates a new user.

- **Method**: `POST`
- **Request**: A `User` object in the request body.
- **Response**:
  - **201 CREATED**: If the user is successfully created.
  - **400 BAD REQUEST**: If there is an issue with the request or user data.

**Example Request:**
```http
POST /public/create-user
Content-Type: application/json

{
  "username": "new_user",
  "password": "secure_password",
}
```
---

## **3. AdminController**

The `AdminController` class provides endpoints for administrative tasks such as managing users.

### **Endpoints**

#### 3.1 **GET /admin/all-users**
Retrieves a list of all users in the system.

- **Method**: `GET`
- **Request**: None
- **Response**:
  - **200 OK**: Returns a list of all users.
  - **404 NOT FOUND**: If no users are found.

**Example Request:**
```http
GET /admin/all-users
```

**Example Response:**
```json
[
  {
  "id": "607d2f8b1e7f1a3f383a914f",
  "userName": "john_doe",
  "password": "secure_password",
  "journalEntries": [
    {
      "id": "607d2f8b1e7f1a3f383a9155",
      "title": "My first journal",
      "content": "Today I learned about Spring Boot...",
      "date": "2025-01-23T12:30:00Z"
    }
  ],
  "roles": ["user"]
  },
  {
  "id": "607d2f8b1e7f1a3f3568eb8",
  "userName": "john_doe_2",
  "password": "secure_password",
  "journalEntries": [
    {
      "id": "607d2f8b1e7f1a3f383a9155",
      "title": "My Favourite Day",
      "content": "It is all about my Favourite Day...",
      "date": "2025-01-23T12:30:00Z"
    }
]
```

#### 3.2 **POST /admin/create-admin-user**
Creates a new admin user.

- **Method**: `POST`
- **Request**: A `User` object in the request body.
- **Response**:
  - **201 CREATED**: If the admin user is successfully created.
  - **400 BAD REQUEST**: If there is an issue with the request.

**Example Request:**
```http
POST /admin/create-admin-user
Content-Type: application/json

{
  "username": "admin_user",
  "password": "secure_password",
}
```
---

## **4. JournalEntryControllerV2**

The `JournalEntryControllerV2` class provides endpoints for managing journal entries related to authenticated users.

### **Endpoints**

#### 4.1 **GET /journal**
Retrieves all journal entries for the authenticated user.

- **Method**: `GET`
- **Request**: None
- **Response**:
  - **200 OK**: Returns a list of journal entries.
  - **404 NOT FOUND**: If no journal entries are found.

**Example Request:**
```http
GET /journal
```

**Example Response:**
```json
[
  {
    "id": "1",
    "title": "My first journal",
    "content": "Today I learned about Spring Boot..."
  },
  {
    "id": "2",
    "title": "A day in the life",
    "content": "I went to the park today and met some friends..."
  }
]
```

#### 4.2 **POST /journal**
Creates a new journal entry for the authenticated user.

- **Method**: `POST`
- **Request**: A `JournalEntry` object in the request body.
- **Response**:
  - **201 CREATED**: If the journal entry is created successfully.
  - **400 BAD REQUEST**: If the request body is invalid.

**Example Request:**
```http
POST /journal
Content-Type: application/json

{
  "title": "My New Journal Entry",
  "content": "This is the content of my journal."
}
```

**Example Response:**
```json
{
  "id": "3",
  "title": "My New Journal Entry",
  "content": "This is the content of my journal."
}
```

#### 4.3 **GET /journal/id/{myId}**
Retrieves a journal entry by its ID.

- **Method**: `GET`
- **Request**: `myId` (ObjectId) as a path variable.
- **Response**:
  - **200 OK**: If the journal entry is found.
  - **404 NOT FOUND**: If the journal entry is not found.

**Example Request:**
```http
GET /journal/id/123456
```

**Example Response:**
```json
{
  "id": "123456",
  "title": "Updated Journal Title",
  "content": "Updated content for the journal entry."
}
```

#### 4.4 **DELETE /journal/id/{myId}**
Deletes a journal entry by its ID.

- **Method**: `DELETE`
- **Request**: `myId` (ObjectId) as a path variable.
- **Response**:
  - **204 NO CONTENT**: If the journal entry is deleted successfully.
  - **404 NOT FOUND**: If the journal entry is not found.

**Example Request:**
```http
DELETE /journal/id/123456
```

#### 4.5 **PUT /journal/id/{myId}**
Updates a journal entry by its ID.

- **Method**: `PUT`
- **Request**: `myId` (ObjectId) as a path variable and an updated `JournalEntry` object in the request body.
- **Response**:
  - **200 OK**: If the journal entry is updated successfully.
  - **404 NOT FOUND**: If the journal entry is not found.
  - **400 BAD REQUEST**: If the request body is invalid.

**Example Request:**
```http
PUT /journal/id/123456
Content-Type: application/json

{
  "title": "Updated Journal Title",
  "content": "Updated content for the journal entry."
}
```

**Example Response:**
```json
{
  "id": "123456",
  "title": "Updated Journal Title",
  "content": "Updated content for the journal entry."
}
```

---

## **5. UserController**

The `UserController` class handles user-specific actions such as updating and deleting user profiles.

### **Endpoints**

#### 5.1 **PUT /user**
Updates the authenticated user's profile.

- **Method**: `PUT`
- **Request**: A `User` object in the request body containing the updated user details.
- **Response**:
  - **200 OK**: If the user profile is successfully updated.

**Example Request:**
```http
PUT /user
Content-Type: application/json

{
  "username": "updated_user",
  "password": "new_password",
}
```

#### 5.2 **DELETE /user**
Deletes the authenticated user's profile.

- **Method**: `DELETE`
- **Request**: A `User` object in the request body.
- **Response**:
  - **200 OK**: If the user is successfully deleted.

**Example Request:**
```http
DELETE /user
Content-Type: application/json

{
  "username": "user_to_delete"
}
```
---

## **Authentication and Security**
All endpoints that deal with user-specific data (e.g., journal entries and user profiles) require the user to be authenticated via Spring Security. The authenticated user must be included in the request context, and their actions are restricted to their own data.

## **Error Handling**
Standard HTTP status codes are used to indicate the success or failure of requests:
- **200 OK**: The request was successful.
- **201 CREATED**: A new resource was created successfully.
- **400 BAD REQUEST**: There was an issue with the request data or body.
- **404 NOT FOUND**: The requested resource could not be found.
- **500 INTERNAL SERVER ERROR**: The server encountered an unexpected error.

---

## **Conclusion**
This API documentation describes the essential endpoints for managing users and journal entries in the Journal App. It covers both public access endpoints for health checks and user registration, as well as authenticated endpoints for user and journal management.
